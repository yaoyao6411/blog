---
title: 密码的加盐存储
date: 2021-01-23 13:25:59
description: 初探
---

什么是加盐，为什么需要加盐参见[这篇](https://zhuanlan.zhihu.com/p/22860282)。

加盐存也还有缺陷，比如攻击者得到账户密码数据库后，针对单个用户的密码，可以用已有的彩虹表（字典攻击）加上该用户的盐再计算匹配得到。所以盐不应与用户名密码存在一起。

但即使加了盐，字典攻击的成本还是不够高，因为普通的hash算法比如SHA太快了。采用慢哈希算法比如bcrypt是常用做法，减缓字典攻击的速度。量化速度比较参见[这篇](https://codahale.com/how-to-safely-store-a-password/)。

慢哈希放在客户端比服务端合适。一种常见的方案是，用户登录时，用户密码先在客户端慢哈希一次，这样hash传到服务端的过程中被截获，也因为慢哈希的原因难以被字典破解；在服务端再经过一次加盐快哈希，这样即使被拖库，也因为要匹配破解的是hash而不是原始简单密码，更难字典破解。